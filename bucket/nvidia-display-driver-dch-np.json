{
    "version": "528.24",
    "description": "NVIDIA display driver.",
    "homepage": "https://www.nvidia.com/Download/index.aspx",
    "license": "Freeware",
    "notes": [
        "This is only an installer for the NVIDIA display driver. Running `scoop uninstall nvidia-display-driver-dch-np` will only unregister it from Scoop.",
        "The NVIDIA display driver installer installs and enables the NVIDIA Display Container LS service, which is required for the NVIDIA Control Panel application but also contains telemetry components.",
        "To disable this functionality and prevent it from being re-enabled on future updates, disable the service using the following commands:",
        "$ Stop-Service NVDisplay.ContainerLocalSystem",
        "$ Set-Service NVDisplay.ContainerLocalSystem -StartupType Disabled"
    ],
    "architecture": {
        "64bit": {
            "url": "https://us.download.nvidia.com/Windows/528.24/528.24-desktop-win10-win11-64bit-international-dch-whql.exe#/dl.7z",
            "hash": "3dc4dc8d2f7ab3ea2d54c6c52ff2db6b1ee56f1572dbf7d8bba5bcac3455c234"
        }
    },
    "installer": {
        "script": [
            "$service_disabled = (Get-CimInstance win32_service -Filter \"name='NVDisplay.ContainerLocalSystem'\").StartMode -eq 'Disabled'",
            "",
            "New-Item \"$dir\\extract\" -ItemType Directory | Out-Null",
            "Move-Item \"$dir\\*\" -Exclude \"extract\" -Destination \"$dir\\extract\"",
            "New-Item \"$dir\\setup\" -ItemType Directory | Out-Null",
            "# Move everything we want",
            "Move-Item \"$dir\\extract\\Display.Driver\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\Display.Optimus\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\HDAudio\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\NVI2\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\PhysX\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\*.txt\" -Destination \"$dir\\setup\"",
            "Move-Item \"$dir\\extract\\setup.*\" -Destination \"$dir\\setup\"",
            "# The installer will not run without these legal files",
            "New-Item \"$dir\\setup\\GFExperience\" -ItemType Directory | Out-Null",
            "Move-Item \"$dir\\extract\\GFExperience\\PrivacyPolicy\" -Destination \"$dir\\setup\\GFExperience\"",
            "Move-Item \"$dir\\extract\\GFExperience\\EULA.html\" -Destination \"$dir\\setup\\GFExperience\"",
            "Move-Item \"$dir\\extract\\GFExperience\\FunctionalConsent*\" -Destination \"$dir\\setup\\GFExperience\"",
            "",
            "if ($service_disabled) {",
            "    Start-Process -Wait -WindowStyle Hidden cmd \"/c call `\"$dir\\setup\\setup.exe`\" -s -noreboot && sc config NVDisplay.ContainerLocalSystem start= disabled && sc stop NVDisplay.ContainerLocalSystem\" -Verb RunAs",
            "} else {",
            "    Start-Process -Wait \"$dir\\setup\\setup.exe\" \"-s -noreboot\" -Verb RunAs",
            "}",
            "",
            "Remove-Item -Recurse \"$dir\\extract\"",
            "Remove-Item -Recurse \"$dir\\setup\""
        ]
    },
    "checkver": {
        "url": "https://gfwsl.geforce.com/services_toolkit/services/com/nvidia/services/AjaxDriverService.php?func=DriverManualLookup&psid=98&osID=57&languageCode=1033&beta=0&isWHQL=1&dltype=-1&dch=1&upCRD=0&sort1=0&numberOfResults=1",
        "regex": "\"Version\"\\s?:\\s?\"(?<version>[\\d.]+)\".*\"DownloadURL\"\\s?:\\s?\"https://us.download.nvidia.com/(?<path>[^\"]*)\""
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://us.download.nvidia.com/$matchPath#/dl.7z"
            }
        }
    }
}
