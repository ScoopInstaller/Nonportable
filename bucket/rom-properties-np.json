{
    "version": "2.7",
    "description": "This shell extension adds a few nice features to file browsers for managing video game ROM and disc images.",
    "homepage": "https://github.com/GerbilSoft/rom-properties",
    "license": "GPL-2.0",
    "url": "https://github.com/GerbilSoft/rom-properties/releases/download/v2.7/SetupRomProperties-2.7.exe",
    "hash": "f18e99ed9d520d1483b35549863ab197bab13cc5e98eb5878300193c007bcdc1",
    "pre_install": "if (!(is_admin)) { error \"Administrator rights are required to install $app\"; break }",
    "installer": {
        "args": [
            "/VERYSILENT",
            "/SUPPRESSMSGBOXES",
            "/SP-",
            "/NOCANCEL",
            "/NORESTART",
            "/NOICONS",
            "/DIR=$dir"
        ]
    },
    "post_install": [
        "info 'Restarting explorer...'",
        "taskkill.exe /F /IM explorer.exe | Out-Null",
        "Start-Sleep -Seconds 2",
        "if (!(Get-Process -Name 'explorer' -ErrorAction SilentlyContinue)) { explorer }"
    ],
    "uninstaller": {
        "script": [
            "if (!(is_admin)) { error \"Administrator rights are required to uninstall $app\"; break }",
            "Start-Process \"$dir\\unins000.exe\" -ArgumentList @('/VERYSILENT', '/SUPPRESSMSGBOXES', '/NORESTART') -Wait -Verb RunAs | Out-Null",
            "info 'Restarting explorer...'",
            "taskkill.exe /F /IM explorer.exe | Out-Null",
            "Start-Sleep -Seconds 2",
            "if (!(Get-Process -Name 'explorer' -ErrorAction SilentlyContinue)) { explorer }"
        ]
    },
    "architecture": {
        "64bit": {
            "bin": [
                "rpcli.exe",
                "amd64/rp-download.exe"
            ]
        },
        "32bit": {
            "bin": [
                "rpcli.exe",
                "i386/rp-download.exe"
            ]
        }
    },
    "shortcuts": [
        [
            "rp-config.exe",
            "ROM Properties Page Configuration"
        ]
    ],
    "checkver": {
        "github": "https://github.com/GerbilSoft/rom-properties",
        "regex": "tag/v([\\d.]+)"
    },
    "autoupdate": {
        "url": "https://github.com/GerbilSoft/rom-properties/releases/download/v$version/SetupRomProperties-$version.exe"
    }
}
